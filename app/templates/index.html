{% from "_macros.html" import render_field, render_tags, user_box %}
{% extends "_base.html" %}

{% block style %}
	<style type="text/css">
		.col-md-2 > a > img {
			width: 25px;
			height: 25px;
			color: white;
		}
	</style>
{% endblock %}

{% block content %}
	
	{% if current_user.is_authenticated %}

<div class="row col-md-offset-1">
	<div class="col-md-2">
		<a type="button" class="btn btn-default btn-block" href="{{url_for('.index', type='movies')}}"> <img src="{{url_for('static', filename='Movie.png')}}"> Movies</a>
	</div>
	<div class="col-md-2 col-md-offset-1">
		<a type="button" class="btn btn-default btn-block" href="{{url_for('.index', type='books')}}"> <img src="{{url_for('static', filename='book.png')}}"> &nbsp; Books</a>
	</div> 
	<div class="col-md-2 col-md-offset-1">
		<a type="button" class="btn btn-default btn-block" href="{{url_for('.index', type='articles')}}"> <img src="{{url_for('static', filename='article.png')}}"> Articles</a>
	</div> 
	<div class="col-md-2 col-md-offset-1">
		<a type="button" class="btn btn-default btn-block" href="{{url_for('.index', type='songs')}}"> <img src="{{url_for('static', filename='audio.png')}}"> &nbsp; Songs</a>
	</div> 
</div>

<br>

	<div class="row">
		<div class="col-md-8 col-md-offset-2">
			<div class="panel panel-default">
			  <div class="panel-body">
				
				{% for row in current_user.get_similar_posts(category) %}
				<div class="panel panel-default">

					<div class="panel-body">
						<h4>Tags</h4>
						{{render_tags(current_user.get_post_tags(row.posts.id))}}
						<h3>{{row.posts.title}}</h3>
						<p>{{row.posts.text}}</p>
						
						<p>Posted on {{row.posts.date}}</p>

						{{user_box(row.user)}}
						
						{% if current_user.has_liked_post(row.posts.id) %}
							<button type="button" class="btn btn-success">Liked</button>
						{% else %}
							<form action="/like-post" method="POST">
								{{like.csrf_token}}
								{{like.post_id(value=row.posts.id)}}
								{{like.submit(class='btn btn-info')}}
							</form>
						{% endif %}
					</div>
				</div>
				{% else %}
					<h4>No posts</h4>
				{% endfor %}

			  </div>
			</div>
		</div>
	</div>
		
	{% endif %}

{% endblock %}